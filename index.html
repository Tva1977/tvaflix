<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TVAFLIX</title>

<style>
body { font-family: Arial; background:#111; color:#fff; margin:0; }
h1 { text-align:center; color:#e50914; margin:20px; }

nav {
    display:flex;
    justify-content:center;
    gap:20px;
    margin-bottom:10px;
}

nav button {
    padding:8px 12px;
    border:none;
    border-radius:5px;
    background:#e50914;
    color:#fff;
    cursor:pointer;
}

#busca {
    display:block;
    margin:10px auto;
    padding:10px;
    width:80%;
    max-width:400px;
    border-radius:6px;
    border:none;
}

.container {
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:20px;
    padding:20px;
}

.filme {
    background:#222;
    padding:10px;
    border-radius:8px;
    width:200px;
    text-align:center;
}

.filme img { width:100%; border-radius:5px; }

.filme button {
    padding:6px 10px;
    background:#e50914;
    border:none;
    color:#fff;
    border-radius:5px;
    cursor:pointer;
}

/* PLAYER */
#player {
    display:none;
    position:fixed;
    inset:0;
    background:#000;
    z-index:999;
}

#player iframe {
    width:100%;
    height:100%;
}

#fechar {
    position:absolute;
    top:10px;
    right:10px;
    background:#e50914;
    border:none;
    color:white;
    padding:10px;
    cursor:pointer;
}
</style>
</head>

<body>

<h1>TVAFLIX</h1>

<nav>
    <button onclick="filtrarPorTipo('filme')">▶ Filmes</button>
    <button onclick="filtrarPorTipo('serie')">📺 Séries</button>
    <button onclick="mostrarFavoritos()">⭐ Favoritos</button>
    <button onclick="login()">👤 Login</button>
</nav>

<input id="busca" placeholder="🔎 Buscar...">

<div class="container" id="container"></div>

<div id="player">
<button id="fechar">Fechar</button>
<iframe id="video" src="" allowfullscreen></iframe>
</div>

<script>
let listaFilmes = [];
let favoritos = [];

function abrirPlayer(url){
    const embed = url.replace("watch?v=", "embed/");
    document.getElementById("video").src = embed;
    document.getElementById("player").style.display = "block";
}

document.getElementById("fechar").onclick = () => {
    document.getElementById("player").style.display = "none";
    document.getElementById("video").src = "";
};

function mostrarFilmes(filmes){
    const container = document.getElementById("container");
    container.innerHTML = "";

    filmes.forEach(filme => {
        const div = document.createElement("div");
        div.className = "filme";

        div.innerHTML = `
            <img src="${filme.poster}">
            <h3>${filme.titulo}</h3>
            <button onclick="abrirPlayer('${filme.trailer}')">▶ Assistir</button>
            <button onclick="adicionarFavorito('${filme.titulo}')">⭐</button>
        `;

        container.appendChild(div);
    });
}

function adicionarFavorito(titulo){
    if(!favoritos.includes(titulo)) {
        favoritos.push(titulo);
        alert(titulo + " adicionado aos favoritos!");
    }
}

function mostrarFavoritos(){
    const favFilmes = listaFilmes.filter(f => favoritos.includes(f.titulo));
    mostrarFilmes(favFilmes);
}

function login(){
    const user = prompt("Digite seu usuário:");
    alert("Olá, " + user + "! (Login simulado)");
}

function filtrarPorTipo(tipo){
    const filtrados = listaFilmes.filter(f => f.tipo === tipo);
    mostrarFilmes(filtrados);
}

fetch('/filmes.json')
.then(r => r.json())
.then(filmes => {
    listaFilmes = filmes;
    mostrarFilmes(listaFilmes);
});

document.getElementById("busca").addEventListener("input", e => {
    const termo = e.target.value.toLowerCase();
    const filtrados = listaFilmes.filter(f => f.titulo.toLowerCase().includes(termo));
    mostrarFilmes(filtrados);
});
</script>

</body>
</html>
